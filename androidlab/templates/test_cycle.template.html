			
<?php if(isset($_GET['test_conf'])) { ?>
<div>
    <b>Status of Emulator</b>
    <hr>
    <font color='grey'>updating automatically in 10 sec...</font>
    <div id="emulator_state"></div>
    <hr>
    <form action='<?php echo $_SERVER["REQUEST_URI"]; ?>' method='post' enctype='multipart/form-data' name='test_configuration_form'>
        <input type='submit' name='stop_emulator' value='Stop Emulator' OnClick="return confirm('Are you sure you want to Stop Emulator?');" />	
        
        <hr>

        <br><b>Select Options for the Test Cycle</b>
        <br>For Emulator <font color='grey'>(counfigures emulator launching, does not have effect if Android Emulator is running)</font><br>
        <table class='table_conf'>
            <tr>
                <td width='400px'>Disable Audio</td>
                <td width='50px'><input type='checkbox' <?php echo (isset($config_array['disable_audio']))?"checked":""; ?> name='selected_conf_options[disable_audio]'></td>
            </tr>
            </tr>
            <tr>
                <td>Enable GPU support for android (could be 'freeze' due to unsupported hardware) </td>
                <td><input type='checkbox' <?php echo (isset($config_array['enable_gpu']))?"checked":""; ?> name='selected_conf_options[enable_gpu]'></td>
            </tr>
            <tr>
                <td>Disable the boot animation</td>
                <td><input type='checkbox' <?php echo (isset($config_array['disable_boot_anim']))?"checked":""; ?> name='selected_conf_options[disable_boot_anim]'></td>
            </tr>
            <tr>
                <td>Disable the emulator's window</td>
                <td><input type='checkbox' <?php echo (isset($config_array['disable_window']))?"checked":""; ?> name='selected_conf_options[disable_window]'></td>
            </tr>
            <tr>
                <td>Use User Profile</td>
                <td><input type='checkbox' <?php echo (isset($config_array['use_profile']))?"checked":""; ?> name='selected_conf_options[use_profile]'></td>
            </tr>
            <tr>
                <td>Intercept nettwork traffic, which is generated by application</td>
                <td><input type='checkbox' <?php echo (isset($config_array['traffic']))?"checked":""; ?> name='selected_conf_options[traffic]'></td>
            </tr>
        </table>
        <br>For ADB <font color='grey'>(affects app launching, can be changed during Android Emulator is running)</font> <br>
        <table class='table_conf'>
            <tr>
                <td width='400px'>Log Installation Process</td>
                <td width='50px'><input type='checkbox' <?php echo (isset($config_array['log_install']))?"checked":""; ?> name='selected_conf_options[log_install]'></td>
            </tr>
            <tr>
                <td>Log Launch Process (20 seconds)</td>
                <td><input type='checkbox' <?php echo (isset($config_array['log_launch']))?"checked":""; ?> name='selected_conf_options[log_launch]'></td>
            </tr> 
            <tr>
                <td>Log Test Process</td>
                <td><input type='checkbox' <?php echo (isset($config_array['log_test']))?"checked":""; ?> name='selected_conf_options[log_test]'></td>
            </tr>
            <tr>
                <td>Log Uninstall Process</td>
                <td><input type='checkbox' <?php echo (isset($config_array['log_uninstall']))?"checked":""; ?> name='selected_conf_options[log_uninstall]'></td>
            </tr>
            <tr>
                <td>Trace System API Calls</td>
                <td><input type='checkbox' <?php echo (isset($config_array['trace']))?"checked":""; ?> name='selected_conf_options[trace]'></td>
            </tr>
            <tr>
                <td>Make Screenshot During Running</td>
                <td><input type='checkbox' <?php echo (isset($config_array['screenshot']))?"checked":""; ?> name='selected_conf_options[screenshot]'></td>
            </tr>
            <tr>
                <td>UI Tester (simulation of user activity -v 100 --throttle 500 --pct-touch 80 --ignore-crashes --ignore-timeouts --kill-process-after-error) </td>
                <td><input type='checkbox' <?php echo (isset($config_array['ui_tester']))?"checked":""; ?> name='selected_conf_options[ui_tester]'></td>
            </tr>
            <tr>
                <td>Check App's CPU and memory usage (20 times)</td>
                <td><input type='checkbox' <?php echo (isset($config_array['read_cpu_usage']))?"checked":""; ?>  name='selected_conf_options[read_cpu_usage]'></td>
            </tr>
            <tr>
                <td>Pull Data from /data/data/package (if exists)</td>
                <td><input type='checkbox' <?php echo (isset($config_array['pull_data']))?"checked":""; ?>  name='selected_conf_options[pull_data]'></td>
            </tr>
            <tr>
                <td>Create BugReport (cat take several minutes; pull the logcat, dumpsys, and dumpstate debug output)</td>
                <td><input type='checkbox' <?php echo (isset($config_array['bugreport']))?"checked":""; ?>  name='selected_conf_options[bugreport]'></td>
            </tr>
   
        </table>
        <br>
        <input type='submit' name='save_config' value='Save Configuration' OnClick="return confirm('Are you sure you want to save configuration?');" />	
    </form>
    <br><br> 

</div>
<?php } if(isset($_GET['testing'])) { ?>
<div>

    <br><b>Status of Emulator</b>
    <hr>
    <font color='grey'>updating automatically in 10 sec...</font>
    <div id="emulator_state"></div>
    <hr>	
    <br><b>Last Performed Tests</b>
    <hr>	
    <font color='grey'>updating automatically in 10 sec...</font>
    <div id="tests_state"></div>
    <form action='<?php echo $_SERVER["REQUEST_URI"]; ?>' method='post' enctype='multipart/form-data' name='test_apps'>

	<hr>
        <br><b>Choose (only one!) Android Virtual Device (AVD) on Emulator for Test Cycle</b><br> <font color='grey'>(with defined configuration below)</font><br>
        <?php	if(isset($available_avds)&&count($available_avds)!==FALSE) { ?>
        <table border='0' align='center' width='800px'>
            <tr class='tr_top_stat'>
                <td><b>Select</b></td>
                <td><b>AVD Name</b></td>
                <td><b>OS Name</b></td>
                <td><b>API Level</b></td>
                <td><b>ABI</b></td>
                <td><b>Skin</b></td>
                <td><b>Path</b></td> 
            </tr>
            <?php	foreach ($available_avds as $i=> $tmp_avd) { ?>
            <?php $tr_class=fmod($i,2)?'row_class1':'row_class2'; ?>
            <tr class=<?php echo $tr_class; ?>>
                <td><input type='radio' checked name='avd_to_run' value='<?php echo $tmp_avd['avd_name']; ?>'></td> 
                <td><?php echo $tmp_avd['avd_name']; ?></td>
                <td><?php echo $tmp_avd['target']; ?></td>
                <td><?php echo $tmp_avd['api_level']; ?></td>
                <td><?php echo $tmp_avd['ABI']; ?></td>
                <td><?php echo $tmp_avd['skins']; ?></td>
                <td><?php echo $tmp_avd['path']; ?></td>
            </tr>
            <?php };  ?>				
        </table>

        <?php } else echo "<i>No Elements!</i>"; ?>
        <br>

		<br><b>Select available Applications for the Test</b><br>	

        <?php	if(isset($list_processed)&count($list_processed)!==FALSE ) { ?>
        <div id='test_apps'>
            <table border='0' align='center' width='800px'>
                <tr class='tr_top_stat'>
                    <td><b> <input type='checkbox' name='checker' onclick="checkAll('test_apps');this.checked=this.checked?false:true;" value='Test'></b></td>
                    <td><b>App ID</b></td>
                    <td><b>App Label</b></td> 
                    <td><b>VesrionName</b></td>
                    <td><b>VesrionCode</b></td>
                    <td><b>Min API Version</b></td>
                    <td><b>Target API Version</b></td>
                    <td><b>Package Name</b></td>

                </tr>
                <?php	foreach ($list_processed as $i=> $processed_app) { ?>
                <?php $tr_class=fmod($i,2)?'row_class1':'row_class2'; ?>
                <tr class=<?php echo $tr_class; ?>>
                    <td><input type='checkbox' name='selectedAppsToTest[<?php echo $i; ?>]' value='<?php echo $processed_app['id_app']; ?>'></td> 
                    <td><?php echo $processed_app['id_app']; ?></td>
                    <td><?php echo $processed_app['app_label']; ?></td>
                    <td><?php echo $processed_app['version']; ?></td>
                    <td><?php echo $processed_app['versionCode']; ?></td>
                    <td><?php echo $processed_app['sdkVersion']; ?></td>
                    <td><?php echo $processed_app['targetSdkVersion']; ?></td>
                    <td><?php echo $processed_app['package_name']; ?></td>

                </tr>
                <?php };  ?>
            </table>
        </div> 
        <br>
        <input type='submit' name='testSelectedApps' value='Test Selected' OnClick="return confirm('Are you sure you want to test these apps?');" />	
        <?php } else echo "<i>No Elements!</i>"; ?>
        <br><br>
    </form>
</div>
<?php }else if(isset($_GET['test_results'])) { ?>

<br><b>Performed Tests</b><br>
<form action='<?php echo $_SERVER["REQUEST_URI"]; ?>' method='post' enctype='multipart/form-data' name='performed_tests_form'>
    <?php	if(isset($list_tests)&count($list_tests)!==FALSE ) { ?>
    <table border='0' align='center' width='800px' >
        <tr class='tr_top_stat'>
            <td><b> <input type='checkbox' name='checker' onclick="checkAll('performed_tests_form');this.checked=this.checked?false:true;" value='Test'></b></td>
            <td><b>Test ID</b></td>
            <td><b>App Label</b></td> 
            <td><b>App ID</b></td> 
            <td><b>App VesrionName</b></td>
            <td><b>AVD Name</b></td>
            <td><b>AVD OS Name</b></td>
            <td><b>Min App SDK (API) Version</b></td>
            <td><b>Finished</b></td>
            <td><b>Duration</b></td>
            <td><b>Errors</b></td>
            <td><b>Info</b></td>
        </tr>
        <?php	foreach ($list_tests as $i=> $test_data) { ?>
        <?php $tr_class=fmod($i,2)?'row_class1':'row_class2'; ?>
        <tr class=<?php echo $tr_class; ?>>
            <td><input type='checkbox' name='selectedTestToDelete[<?php echo $i; ?>]' value='<?php echo $test_data['id_test']; ?>'></td> 
            <td><?php echo $test_data['id_test']; ?></td>
            <td><?php echo $test_data['id_app']; ?></td>
            <td><?php echo $test_data['app_label']; ?></td>
            <td><?php echo $test_data['version']; ?></td>
            <td><?php echo $test_data['avd_name']==''?"<font color='grey'>was deleted</font>": $test_data['avd_name']; ?></td>
            <td><?php echo $test_data['target']==''?"<font color='grey'>was deleted</font>": $test_data['target']; ?></td>
            <td><?php echo $test_data['sdkVersion']; ?></td>
            <td><?php echo $test_data['time']; ?></td>
            <td><?php echo $test_data['duration']; ?></td>
            <td><?php echo $test_data['errors']; ?></td>
            <td>
                <a href="javascript:toggleDiv('hidContent<?php echo $i; ?>');" class="more_button" >More</a>
            </td>	
        </tr>

        <tr>
            <td colspan="12" class="tr_hidden">
                <div id='hidContent<?php echo $i; ?>' class="hiddenDesc" style=" padding: 5px 10px;">

                    <table class="table_hidden"  style='table-layout:fixed'>
                        <tr>
                            <td width='100px'><b>Routine Output</b></td>
                            <td><pre><?php echo $test_data['test_app_process_echo']; ?></pre></td>
                        </tr>
                        <tr>
                            <td><b>Log Install</b></td>
                            <td><pre><?php echo $test_data['log_install']; ?></pre></td>
                        </tr>
                        <tr>
                            <td><b>Log Launch</b></td>
                            <td><pre><?php echo $test_data['log_launch']; ?></pre></td>
                        </tr>
                        <tr>
                            <td><b>Log Test</b></td>
                            <td><pre><?php echo $test_data['log_test']; ?></pre></td>
                        </tr>
                        <tr>
                            <td><b>Log Uninstall</b></td>
                            <td><pre><?php echo $test_data['log_uninstall']; ?></pre></td>
                        </tr>
                    </table>

                </div>
            <td>
        </tr> 
        <?php };  ?>
    </table>

    <br>
    <input type='submit' name='deleteSelectedTests' value='Delete Test Data' OnClick="return confirm('Are you sure you want to delete selected tests data?\nALL CORRESPONDING ANALYSIS DATA WILL BE DELTED!!!');" />	
    <?php } else echo "<i>No Elements!</i>"; ?>
    <br><br>
</form>

<?php } else if(!count($_GET)) { ?>
<h4>Current page is designed for performing variety of Tests of uploaded Applications </h4> 
You can adjust Test Cycle configuration, Start/Stop Android Virtual Device and perform test on selected applications.
<br>
<?php }; ?>
<br>

